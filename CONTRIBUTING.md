# Contributing to GOBL

<img src="https://github.com/invopop/gobl/blob/main/gobl_logo_black_rgb.svg?raw=true" width="181" height="219" alt="GOBL Logo">

Go Business Language. Core library, schemas, and CLI.

Released under the Apache 2.0 [LICENSE](https://github.com/invopop/gobl/blob/main/LICENSE), Copyright 2021-2025 [Invopop S.L.](https://invopop.com).

## Language

The preferred language for contributions is English (American).

## Key Directories

GOBL is organized into several directories, each with a specific purpose:

- **addons**: Stores optional modules or extensions for GOBL.
- **bill**: Contains invoice implementation including structure, validation, and calculation logic.
- **c14n** (Canonicalization): Handles XML canonicalization for digital signatures.
- **cal**: Provides calendar and date handling utilities used throughout GOBL.
- **catalogues**: Contains predefined lists or catalogues used in GOBL (e.g., product codes, standard lists).
- **cbc** (Common Basic Components): Defines common basic components like keys, codes, and definitions used across the codebase.
- **cmd**: Contains command-line interface tools for working with GOBL documents.
- **currency**: Manages currency codes, exchange rates, and monetary value handling.
- **data**: Autogenerated. Holds embedded data files and other resources required by GOBL.
- **dsig**: Implements digital signature functionality for document verification.
- **examples**: Contains sample GOBL documents for reference and testing.
- **head**: Contains header information or metadata used within GOBL documents.
- **i18n** (Internationalization): Provides internationalization support for multilingual text throughout GOBL.
- **internal**: Houses internal utilities not intended for external use.
- **l10n** (Localization): Handles localization with country codes and regional definitions.
- **note**: Defines structures for notes or messages within GOBL documents.
- **num**: Implements numeric types and calculations for precise monetary operations.
- **org**: Defines organization and party data structures used in business documents.
- **pay**: Manages payment-related structures and logic (e.g., payment means, terms).
- **pkg**: Contains shared utilities and helpers used across the codebase.
- **regimes**: Implements country-specific tax rules, rates, and validation logic.
- **schema**: Contains JSON Schema definitions (auto-generated).
- **tax**: Provides core tax-related functionality including regime definitions and validation.
- **uuid**: Handles UUID generation for document and entity identification.
- **wasm**: Implements WebAssembly integration for browser-based GOBL usage.


## Development

GOBL uses the `go generate` command to automatically generate JSON schemas, definitions, and some Go code output. After any changes, be sure to run:

```bash
go generate .
```

#### Installing tools

We use a [`tools.go`](tools.go) file to track the tools we use.

Simply run `go mod tidy` to install them.

Note: In Go 1.24 a new way to manage tools was introduced. Once this project upgrades to >1.24, we'll be able to use the `tools` directive in `go.mod` (`go get -tool ...`), remove the `tools.go` file and use `go tool golangci-lint run` to run the linter. For now, the above method is the right way.

### Linting and formatting

[golangci-lint](https://golangci-lint.run/) is used to check the code for errors and style issues. The configuration is in the [`.golangci.yaml`](.golangci.yaml) file.

Curent version is 1.64.8.

#### Running

```bash
golangci-lint run
golangci-lint run --fix # To autofix lint errors where possible
```

#### VS Code setup

[Official docs](https://golangci-lint.run/welcome/integrations/#visual-studio-code)

Add this to your `settings.json` file:

```json
"go.lintTool": "golangci-lint",
"go.lintFlags": [
  "--path-mode=abs",
  "--fast-only"
],
"go.formatTool": "custom",
"go.alternateTools": {
  "customFormatter": "golangci-lint"
},
"go.formatFlags": [
  "fmt",
  "--stdin"
]
```

## Adding a new regime

- Create a new directory in the `regimes` folder with the 2-letter country code (regime code).
- Add the necessary files and code to the new directory.
  - `<regime_code>.go`
  - `tax_categories.go`
  - `tax_identity.go`
  - `corrections.go`
  - `scenarios.go`
  - `invoices.go`
  - `invoices_test.go`
- Add the new regime to the `regimes.go` file.
- Add the new regime to the `regimes_test.go` file.