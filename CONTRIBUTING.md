# Contributing to GOBL

<img src="https://github.com/invopop/gobl/blob/main/gobl_logo_black_rgb.svg?raw=true" width="181" height="219" alt="GOBL Logo">

Go Business Language. Core library, schemas, and CLI.

Released under the Apache 2.0 [LICENSE](https://github.com/invopop/gobl/blob/main/LICENSE), Copyright 2021-2025 [Invopop S.L.](https://invopop.com).

## Language

The preferred language for contributions is English (American).

## Key Directories

GOBL is organized into several directories, each with a specific purpose:

- **addons**: Stores optional modules or extensions for GOBL to support local or international formats.
- **bill**: Contains billing logic, including support for invoices, deliveries, orders, and payments, with calculations and validation rules.
- **c14n** (Canonicalization): Handles JSON canonicalization for digital signatures.
- **cal**: Provides calendar and date handling utilities.
- **catalogues**: Contains predefined lists or catalogues of international standards to be used in extensions.
- **cbc** (Common Basic Components): Defines common basic components like keys, codes, and definitions used across the codebase.
- **cmd**: Contains command-line interface tools for working with GOBL documents.
- **currency**: Manages currency codes, exchange rates, and monetary value handling.
- **data**: Autogenerated. Holds embedded data files and other resources required by GOBL.
- **dsig**: Implements digital signature functionality for document verification.
- **examples**: Contains sample GOBL documents for reference and testing.
- **head**: Contains header information or metadata used within GOBL envelopes.
- **i18n** (Internationalization): Provides internationalization support for multilingual text throughout GOBL.
- **internal**: Houses internal utilities not intended for external use.
- **l10n** (Localization): Handles localization with country codes and regional definitions.
- **note**: Defines structures for notes or messages within GOBL envelopes or documents.
- **num**: Implements numeric types and calculations for precise monetary operations.
- **org**: Defines organization and party data structures used in business documents.
- **pay**: Manages payment-related structures and logic (e.g., payment means, terms, instructions).
- **pkg**: Contains shared utilities and helpers used across the codebase.
- **regimes** (Tax Regimes): Implements country-specific tax rules, rates, and validation logic.
- **schema**: Handles the logic for dealing with JSON schemas.
- **tax**: Provides core tax-related structures and functionality to be used inside documents and as part of addon or regime definitions.
- **uuid**: Utility to handles UUID generation.
- **wasm**: Implements WebAssembly integration for browser-based GOBL usage.

## Development

GOBL uses the `go generate` command to automatically generate JSON schemas, definitions, and some Go code output. After any changes, be sure to run:

```bash
go generate .
```

#### Installing tools

We use a [`tools.go`](tools.go) file to track the tools we use.

Simply run `go mod tidy` to install them.

Note: In Go 1.24 a new way to manage tools was introduced. Once this project upgrades to >1.24, we'll be able to use the `tools` directive in `go.mod` (`go get -tool ...`), remove the `tools.go` file and use `go tool golangci-lint run` to run the linter. For now, the above method is the right way.

### Linting and formatting

[golangci-lint](https://golangci-lint.run/) is used to check the code for errors and style issues. The configuration is in the [`.golangci.yaml`](.golangci.yaml) file.

Current version is 1.64.8.

#### Running

```bash
golangci-lint run
golangci-lint run --fix # To autofix lint errors where possible
```

#### VS Code setup

[Official docs](https://golangci-lint.run/welcome/integrations/#visual-studio-code)

Add this to your `settings.json` file:

```json
"go.lintTool": "golangci-lint",
"go.lintFlags": [
  "--path-mode=abs",
  "--fast-only"
],
"go.formatTool": "custom",
"go.alternateTools": {
  "customFormatter": "golangci-lint"
},
"go.formatFlags": [
  "fmt",
  "--stdin"
]
```

## Where to Make Changes

GOBL is structured in multiple layers, and choosing the right place for your contribution is important. Consider these four main layers:

1. **GOBL Core**: The foundational packages (e.g., `bill`, `cbc`, `tax`, etc.). Changes here are reviewed carefully, as they affect the entire ecosystem and must align with best practices.
2. **Tax Regimes**: Subdirectories within the `regimes` package, each implementing country-specific tax rules, rates, and validation logic. See [`regimes/README.md`](regimes/README.md) for details.
3. **Addons**: Extensions that handle specialized formats or unique normalization/validation rules. Addons may define extension codes to support reliable conversion of GOBL documents.
4. **External Applications**: Business logic that doesn't fit within GOBL itself, typically because it involves relationships between documents or relies on persistent storage.

If you're unsure where your change belongs, feel free to open an issue or discussion for guidance.
